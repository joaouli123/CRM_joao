‚ùå Problema 1: Mensagens enviadas pelo frontend n√£o aparecem no chat

    Voc√™ digita uma mensagem no painel e clica "enviar", mas:

    Ela n√£o aparece na interface

    E o contato n√£o recebe no WhatsApp

‚ùå Problema 2: Mensagens recebidas n√£o aparecem em tempo real

    Contatos te enviam mensagens, mas:

    Elas n√£o aparecem automaticamente no chat

    Voc√™ s√≥ v√™ depois de atualizar manualmente ou relogar

Vamos tratar ambos de forma clara, objetiva e pronta para sua IA resolver.
‚úÖ PROMPT COMPLETO PARA A IA ‚Äî MENSAGENS N√ÉO S√ÉO ENTREGUES NEM RECEBIDAS EM TEMPO REAL

    ‚ö†Ô∏è Estou com dois problemas principais que precisam ser resolvidos agora:

‚ùå 1. Mensagens enviadas n√£o chegam ao WhatsApp

        No frontend, o bot√£o ‚Äúenviar‚Äù dispara a fun√ß√£o sendMessage()

        Mas a mensagem:

            ‚ùå N√£o aparece no chat local

            ‚ùå N√£o chega ao WhatsApp do contato

    Verifique:

        Se a fun√ß√£o sendMessage() est√° chamando corretamente o endpoint:

POST /message/sendText/{{instanceName}}

Com corpo:

        {
          "number": "55XXXXXXXXXXX",
          "text": "mensagem enviada"
        }

        Se o n√∫mero est√° sem o sufixo @s.whatsapp.net (tem que ser apenas o n√∫mero puro)

        Se est√° passando o instanceName correto (n√£o o instanceId)

        Se a API responde com sucesso (200 OK) ou erro (400, 401, 404)

        Se a resposta do envio est√° sendo logada no console para confirma√ß√£o

    Ap√≥s o envio, adicione a mensagem manualmente no estado setMessages([...]) para refletir na interface.

‚ùå 2. Mensagens recebidas n√£o aparecem em tempo real

        O WebSocket est√° conectado, mas os eventos messages.upsert ou message n√£o est√£o sendo escutados corretamente

    Por favor, verifique:

        Se o WebSocket foi conectado com:

const socket = io(`wss://evolution.lowfy.com.br/instance/${instanceId}`, {
  transports: ['websocket'],
  extraHeaders: {
    Authorization: 'Bearer {{API_KEY}}'
  }
});

Se h√°:

socket.onAny((event, data) => {
  console.log("üì° Evento WebSocket:", event, data);
});

Se est√° escutando:

        socket.on("messages.upsert", (data) => {
          const chatId = data.key.remoteJid;
          if (chatId === chatAtual) {
            setMessages((prev) => [...prev, data]);
          } else {
            atualizarPreviewContato(chatId, data);
          }
        });

        Se a inst√¢ncia do WebSocket est√° corretamente vinculada ao instanceId atual.

        Se o sessionData carrega os dados certos para essa inst√¢ncia ativa.

    Importante: cada inst√¢ncia deve ter seu pr√≥prio canal WebSocket (multi-inst√¢ncia).

‚úÖ O que espero agora:

        Que mensagens enviadas pelo sistema cheguem ao WhatsApp do contato

        Que mensagens enviadas pelos contatos apare√ßam em tempo real

        Que o setMessages() atualize o chat atual corretamente

